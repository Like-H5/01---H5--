<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>轮播图新增</title>
    <link rel="stylesheet" href="/css/add.css">
</head>
<body>
<!--
注意事项:
    1. 需要按照接口信息, 填写action  method 字段名称
    2. 上传图片是, 需要对文件类型进行过滤(accept过滤和js过滤)
-->
<form enctype="multipart/form-data" id="sz_form">
    <label>
        <input type="text" placeholder="请输入轮播图标题" name="title">
    </label>
    <label>
        <input type="file" name="lb_img" accept="image/*">
    </label>
    <input type="submit" value="提交">
</form>
<script src="./js/axios.min.js"></script>

<script>

    sz_form.onsubmit = function (evt) {
        evt.preventDefault();

        let titleV = sz_form.title.value;
        if(titleV.length === 0) {
            alert("请输入标题")
            return;
        }
        let pathArray = sz_form.lb_img.value.split(".")
        let extName = pathArray[pathArray.length - 1]
        if (!["jpg", "jpeg", "png"].includes(extName)) {
            alert("请传入图片文件")
            return;
        }

        // 借助网络请求库, 手动调用对应的后端上传接口
        let file = sz_form.lb_img.files[0];
        let formData = new FormData();
        formData.append("title", titleV);
        formData.append("lb_img", file, file.name);

        axios.post("http://localhost:5000/lb/add", formData).then(({data})=>{
            console.log(data)
            if (data.code === 0) {
                window.location = "/success.html"
            }
        }).catch(error=>{
            console.log(error.message)
        })

    }


</script>

</body>
</html>